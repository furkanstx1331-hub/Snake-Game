<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Omega 3D</title>
<style>
body{margin:0;overflow:hidden;background:black;color:white;font-family:Arial}
#menu{
position:absolute;top:20px;left:20px;z-index:10;
}
button{
padding:8px 15px;margin:5px;
background:#00ffee;border:none;
font-weight:bold;cursor:pointer;border-radius:6px;
}
</style>
</head>
<body>

<div id="menu">
<button onclick="startGame()">3D Başlat</button>
<button onclick="connectOnline()">Online Bağlan</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>
let scene,camera,renderer;
let snake=[],direction=new THREE.Vector3(1,0,0);
let food;
let gridSize=20;
let speed=200;
let gameInterval;
let socket=null;

function init(){
scene=new THREE.Scene();
camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);

camera.position.set(0,50,50);
camera.lookAt(0,0,0);

const light=new THREE.PointLight(0x00ffee,2);
light.position.set(20,50,20);
scene.add(light);

createSnake();
createFood();
animate();
}

function createSnake(){
snake=[];
for(let i=0;i<5;i++){
const cube=new THREE.Mesh(
new THREE.BoxGeometry(1,1,1),
new THREE.MeshStandardMaterial({color:0x00ffee,emissive:0x00ffee})
);
cube.position.set(-i,0,0);
scene.add(cube);
snake.push(cube);
}
}

function createFood(){
const geo=new THREE.BoxGeometry(1,1,1);
const mat=new THREE.MeshStandardMaterial({color:0xff0000});
food=new THREE.Mesh(geo,mat);
food.position.set(randPos(),0,randPos());
scene.add(food);
}

function randPos(){
return Math.floor(Math.random()*gridSize)-gridSize/2;
}

function moveSnake(){
const headPos=snake[0].position.clone();
headPos.add(direction);

if(headPos.distanceTo(food.position)<1){
createFood();
}else{
const tail=snake.pop();
tail.position.copy(headPos);
snake.unshift(tail);
return;
}

const newCube=new THREE.Mesh(
new THREE.BoxGeometry(1,1,1),
new THREE.MeshStandardMaterial({color:0x00ffee,emissive:0x00ffee})
);
newCube.position.copy(headPos);
scene.add(newCube);
snake.unshift(newCube);
}

document.addEventListener("keydown",e=>{
if(e.key==="ArrowUp")direction.set(0,0,-1);
if(e.key==="ArrowDown")direction.set(0,0,1);
if(e.key==="ArrowLeft")direction.set(-1,0,0);
if(e.key==="ArrowRight")direction.set(1,0,0);
});

function animate(){
requestAnimationFrame(animate);
renderer.render(scene,camera);
}

function startGame(){
init();
gameInterval=setInterval(moveSnake,speed);
}

function connectOnline(){
socket=new WebSocket("ws://localhost:8080");
socket.onopen=()=>alert("Online Bağlandı!");
socket.onmessage=(msg)=>console.log(msg.data);
}
</script>

</body>
</html>

